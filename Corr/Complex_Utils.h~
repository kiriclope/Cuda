__device__ inline Complex ComplexScale(Complex a, float s)

{

  Complex c;

  c.x = s * a.x;

  c.y = s * a.y;

  return c;

}



__device__ inline Complex ComplexMul(Complex a, Complex b)

{

  Complex c;

  c.x = a.x * b.x - a.y * b.y;

  c.y = a.x * b.y + a.y * b.x;

  return c;

}



__global__ void ComplexPointwiseMulAndScale(Complex* a, const Complex* b, int size, float scale)

{

  const int numThreads = blockDim.x * gridDim.x;

  const int index = blockIdx.x * blockDim.x + threadIdx.x;

  for (int i = index; i < size; i += numThreads)

    a[i] = ComplexScale(ComplexMul(a[i], b[i]), scale);     

}
